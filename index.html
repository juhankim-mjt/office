<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MBTI → 어울리는 강아지 심리테스트</title>
<style>
  body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:#f7f7fb;color:#222;padding:20px}
  .container{max-width:880px;margin:0 auto;background:#fff;border-radius:12px;padding:20px;box-shadow:0 6px 24px rgba(20,20,50,0.06)}
  h1{margin:0 0 8px;font-size:22px}
  p.lead{margin:0 0 16px;color:#555}
  .q{padding:14px;border-radius:10px;border:1px solid #eee;margin-bottom:12px;background:#fcfcff}
  .q h3{margin:0 0 8px;font-size:16px}
  .btn-row{display:flex;gap:8px}
  .btn{flex:1;padding:10px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer}
  .btn:hover{box-shadow:0 3px 10px rgba(0,0,0,0.06)}
  #result{margin-top:18px;padding:16px;border-radius:10px;border:1px dashed #dfe6ff;background:#fbfbff}
  .result-title{font-weight:700;font-size:18px;margin-bottom:8px}
  .result-body{white-space:pre-wrap;color:#333}
  .actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap}
  .action-btn{padding:8px 12px;border-radius:8px;border:0;background:#3b82f6;color:#fff;cursor:pointer}
  .action-btn.secondary{background:#6b7280}
  canvas{display:block;margin-top:12px;border-radius:8px;border:1px solid #eee}
  footer{margin-top:16px;font-size:13px;color:#666}
</style>
</head>
<body>
<div class="container">
  <h1>MBTI로 보는 나랑 어울리는 강아지 테스트 🐶</h1>
  <p class="lead">아래 질문에 모두 답하면 당신의 MBTI를 추정하고, 그 MBTI와 어울리는 강아지 견종과 설명을 보여드립니다.</p>

  <div id="quiz"></div>

  <div style="text-align:center;margin-top:10px">
    <button id="submit" class="action-btn">결과 보기</button>
    <button id="reset" class="action-btn secondary">다시하기</button>
  </div>

  <div id="result" style="display:none">
    <div class="result-title" id="result-title"></div>
    <div class="result-body" id="result-body"></div>
    <div class="actions">
      <button id="shareKakao" class="action-btn">카카오톡 공유하기</button>
      <button id="copyText" class="action-btn secondary">텍스트 복사</button>
    </div>
    <canvas id="cardCanvas" width="820" height="420" style="display:none"></canvas>
  </div>

  <footer>👉 강아지 PNG 이미지는 DOG_IMAGES 매핑 테이블에 직접 교체하세요.</footer>
</div>

<!-- 카카오 SDK -->
<script src="https://developers.kakao.com/sdk/js/kakao.js"></script>
<script>
  Kakao.init("여기에_본인_Javascript_앱키"); // ⚠️ 발급받은 앱키 입력
</script>

<script>
/* MBTI → 견종 매핑 */
const DATA = {
  questions: [
    {id:1,text:"파티에 가면 주로 무엇을 하나요?",a:{text:"사람들과 어울려 먼저 말 거는 편 (E)",score:{E:1}},b:{text:"조용히 관찰하거나 친한 사람만 만나는 편 (I)",score:{I:1}}},
    {id:2,text:"결정할 때 무엇에 더 의지하나요?",a:{text:"현실적 사실과 경험 (S)",score:{S:1}},b:{text:"직관과 가능성 (N)",score:{N:1}}},
    {id:3,text:"갈등 상황에서 나는?",a:{text:"논리(원인·해결) 중심으로 접근 (T)",score:{T:1}},b:{text:"감정과 관계를 고려해 결론 (F)",score:{F:1}}},
    {id:4,text:"계획 세울 때 나는?",a:{text:"미리 계획해 두는 편 (J)",score:{J:1}},b:{text:"즉흥적으로 유연하게 가는 편 (P)",score:{P:1}}},
    {id:5,text:"휴일에 당신이라면?",a:{text:"여럿이랑 활동적으로 보내기 (E)",score:{E:1}},b:{text:"집에서 혼자/적은 사람과 쉬기 (I)",score:{I:1}}},
    {id:6,text:"새로운 것 배울 때 선호는?",a:{text:"검증된 방법과 실습 (S)",score:{S:1}},b:{text:"이론·원리·아이디어 먼저 (N)",score:{N:1}}},
    {id:7,text:"친구가 고민 상담하면 당신은?",a:{text:"직설적으로 핵심 지적 (T)",score:{T:1}},b:{text:"공감하고 감정 먼저 안정 (F)",score:{F:1}}},
    {id:8,text:"일할 때 당신의 스타일은?",a:{text:"마감·목표 맞춰 체계적으로 (J)",score:{J:1}},b:{text:"상황에 따라 유연하게 변경 (P)",score:{P:1}}}
  ],
  mbti_to_dog: {
    "ISTJ":{"breed":"German Shepherd","dog_personality":"책임감 있고 신중하며 충성심 강함.","mbti_desc":"ISTJ: 현실적이고 실용적인 관리자형."},
    "ISFJ":{"breed":"Golden Retriever","dog_personality":"온화하고 가족 지향적.","mbti_desc":"ISFJ: 온화한 수호자형."},
    "INFJ":{"breed":"Cavalier King Charles Spaniel","dog_personality":"섬세하고 온순, 조용한 애교형.","mbti_desc":"INFJ: 이상주의적 조언자."},
    "INTJ":{"breed":"Shiba Inu","dog_personality":"독립적이고 고집스러움.","mbti_desc":"INTJ: 전략가형."},
    "ISTP":{"breed":"Jack Russell Terrier","dog_personality":"모험적이고 활동적.","mbti_desc":"ISTP: 장인형 문제 해결자."},
    "ISFP":{"breed":"Beagle","dog_personality":"감성적이고 호기심 많음.","mbti_desc":"ISFP: 예술가형."},
    "INFP":{"breed":"Samoyed","dog_personality":"온화하고 따뜻함.","mbti_desc":"INFP: 중재자형."},
    "INTP":{"breed":"Basenji","dog_personality":"지적이고 탐구심 강함.","mbti_desc":"INTP: 분석가형."},
    "ESTP":{"breed":"Boxer","dog_personality":"활발하고 즉흥적.","mbti_desc":"ESTP: 실행가형."},
    "ESFP":{"breed":"Labrador Retriever","dog_personality":"사교적이고 즐거움을 추구.","mbti_desc":"ESFP: 연예인형."},
    "ENFP":{"breed":"Poodle","dog_personality":"창의적이고 장난꾸러기.","mbti_desc":"ENFP: 재능발견가."},
    "ENTP":{"breed":"Australian Shepherd","dog_personality":"기민하고 장난기 많음.","mbti_desc":"ENTP: 발명가형."},
    "ESTJ":{"breed":"Rottweiler","dog_personality":"책임감 강하고 보호 본능.","mbti_desc":"ESTJ: 집행자형."},
    "ESFJ":{"breed":"Corgi","dog_personality":"사교적이고 타인을 챙김.","mbti_desc":"ESFJ: 제공자형."},
    "ENFJ":{"breed":"Border Collie","dog_personality":"리더십 있고 활발.","mbti_desc":"ENFJ: 언어로 이끄는 리더."},
    "ENTJ":{"breed":"Siberian Husky","dog_personality":"에너지 넘치고 도전적.","mbti_desc":"ENTJ: 통솔자형."}
  },
  result_template: {
    title:"당신의 MBTI: {mbti} — 어울리는 강아지: {breed}",
    body:"{mbti_desc}\n\n강아지 성격: {dog_personality}\n\n해석: {interpretation}"
  }
};

/* 견종별 샘플 이미지 URL */
const DOG_IMAGES = {
  "German Shepherd":"https://place-puppy.com/400x200?image=1",
  "Golden Retriever":"https://place-puppy.com/400x200?image=2",
  "Cavalier King Charles Spaniel":"https://place-puppy.com/400x200?image=3",
  "Shiba Inu":"https://place-puppy.com/400x200?image=4",
  "Jack Russell Terrier":"https://place-puppy.com/400x200?image=5",
  "Beagle":"https://place-puppy.com/400x200?image=6",
  "Samoyed":"https://place-puppy.com/400x200?image=7",
  "Basenji":"https://place-puppy.com/400x200?image=8",
  "Boxer":"https://place-puppy.com/400x200?image=9",
  "Labrador Retriever":"https://place-puppy.com/400x200?image=10",
  "Poodle":"https://place-puppy.com/400x200?image=11",
  "Australian Shepherd":"https://place-puppy.com/400x200?image=12",
  "Rottweiler":"https://place-puppy.com/400x200?image=13",
  "Corgi":"https://place-puppy.com/400x200?image=14",
  "Border Collie":"https://place-puppy.com/400x200?image=15",
  "Siberian Husky":"https://place-puppy.com/400x200?image=16"
};

/* --- DOM --- */
const quizEl=document.getElementById('quiz');
const submitBtn=document.getElementById('submit');
const resetBtn=document.getElementById('reset');
const resultBlock=document.getElementById('result');
const resultTitle=document.getElementById('result-title');
const resultBody=document.getElementById('result-body');
const shareKakaoBtn=document.getElementById('shareKakao');
const copyTextBtn=document.getElementById('copyText');
const canvas=document.getElementById('cardCanvas');
const ctx=canvas.getContext('2d');
let answers={};

/* --- UI --- */
function renderQuiz(){
  quizEl.innerHTML='';
  DATA.questions.forEach(q=>{
    const qdiv=document.createElement('div');qdiv.className='q';
    qdiv.innerHTML=`<h3>${q.id}. ${q.text}</h3>`;
    const row=document.createElement('div');row.className='btn-row';
    const aBtn=document.createElement('button');aBtn.className='btn';aBtn.textContent='A. '+q.a.text;
    const bBtn=document.createElement('button');bBtn.className='btn';bBtn.textContent='B. '+q.b.text;
    aBtn.onclick=()=>{answers[q.id]='a';markSelected(q.id);};
    bBtn.onclick=()=>{answers[q.id]='b';markSelected(q.id);};
    row.appendChild(aBtn);row.appendChild(bBtn);qdiv.appendChild(row);
    quizEl.appendChild(qdiv);
  });
}
function markSelected(qid){
  const qdiv=quizEl.querySelectorAll('.q')[qid-1];
  const btns=qdiv.querySelectorAll('.btn');
  btns.forEach(b=>b.style.borderColor='#ddd');
  const c=answers[qid];
  if(c==='a')btns[0].style.borderColor='#3b82f6';
  if(c==='b')btns[1].style.borderColor='#3b82f6';
}
function calcMBTI(){
  const s={E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0};
  for(const q of DATA.questions){
    const pick=answers[q.id];if(!pick)continue;
    const sc=(pick==='a')?q.a.score:q.b.score;
    for(const k in sc)s[k]+=sc[k];
  }
  const letter=(s.E>=s.I?'E':'I')+(s.S>=s.N?'S':'N')+(s.T>=s.F?'T':'F')+(s.J>=s.P?'J':'P');
  return{letter,score:s};
}
function makeInterpretation(mbti){
  const base=DATA.mbti_to_dog[mbti];
  return `당신은 ${mbti} 성향으로, ${base.mbti_desc}\n${base.dog_personality} 특성과 잘 어울립니다.`;
}
function showResult(){
  if(Object.keys(answers).length<DATA.questions.length){alert('모든 질문에 답해주세요!');return;}
  const {letter}=calcMBTI();
  const info=DATA.mbti_to_dog[letter];
  const interp=makeInterpretation(letter);
  const title=DATA.result_template.title.replace('{mbti}',letter).replace('{breed}',info.breed);
  const body=DATA.result_template.body.replace('{mbti_desc}',info.mbti_desc).replace('{dog_personality}',info.dog_personality).replace('{interpretation}',interp);
  resultTitle.textContent=title;resultBody.textContent=body;resultBlock.style.display='block';
  quizEl.style.display='none';submitBtn.style.display='none';
  drawCard(letter,info,interp);
  shareKakaoBtn.onclick=()=>{
    const dogImg=DOG_IMAGES[info.breed]||"https://place-puppy.com/400x200";
    Kakao.Share.sendDefault({
      objectType:"feed",
      content:{
        title:title,
        description:body.substring(0,80)+"...",
        imageUrl:dogImg,
        link:{mobileWebUrl:window.location.href,webUrl:window.location.href}
      },
      buttons:[{title:"나도 테스트 해보기",link:{mobileWebUrl:window.location.origin,webUrl:window.location.origin}}]
    });
  };
}
function drawCard(mbti,info,interp){
  const w=canvas.width,h=canvas.height;
  ctx.fillStyle='#fff';ctx.fillRect(0,0,w,h);
  ctx.fillStyle='#f1f5f9';ctx.fillRect(0,0,320,h);
  ctx.fillStyle='#222';ctx.font='bold 32px sans-serif';ctx.fillText(info.breed,18,60);
  ctx.font='24px sans-serif';ctx.fillText('MBTI: '+mbti,18,100);
  ctx.font='80px serif';ctx.fillText('🐶',110,220);
  ctx.fillStyle='#111827';ctx.font='20px sans-serif';wrapText(ctx,info.mbti_desc,340,40,460,26);
  ctx.font='18px sans-serif';wrapText(ctx,'강아지 성격: '+info.dog_personality,340,180,460,22);
  ctx.font='16px sans-serif';wrapText(ctx,interp,340,260,460,20);
  canvas.style.display='block';
}
function wrapText(ctx,text,x,y,maxWidth,lineHeight){
  const words=text.split(' ');let line='';
  for(let n=0;n<words.length;n++){
    const test=line+words[n]+' ';const w=ctx.measureText(test).width;
    if(w>maxWidth&&n>0){ctx.fillText(line,x,y);line=words[n]+' ';y+=lineHeight;}
    else line=test;
  }
  ctx.fillText(line,x,y);
}
submitBtn.onclick=showResult;
resetBtn.onclick=()=>{answers={};renderQuiz();resultBlock.style.display='none';canvas.style.display='none';quizEl.style.display='block';submitBtn.style.display='inline';};
copyTextBtn.onclick=()=>{const text=resultTitle.textContent+"\n\n"+resultBody.textContent;navigator.clipboard.writeText(text).then(()=>alert('결과가 복사되었습니다.'));};

/* 초기 실행 */
renderQuiz();
</script>
</body>
</html>
