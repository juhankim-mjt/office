<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>MBTI â†’ ì–´ìš¸ë¦¬ëŠ” ê°•ì•„ì§€ ì‹¬ë¦¬í…ŒìŠ¤íŠ¸</title>
<style>
  body{font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Noto Sans KR',sans-serif;background:#f7f7fb;color:#222;padding:20px}
  .container{max-width:880px;margin:0 auto;background:#fff;border-radius:12px;padding:20px;box-shadow:0 6px 24px rgba(20,20,50,0.06)}
  h1{margin:0 0 8px;font-size:22px}
  p.lead{margin:0 0 16px;color:#555}
  .q{padding:14px;border-radius:10px;border:1px solid #eee;margin-bottom:12px;background:#fcfcff}
  .q h3{margin:0 0 8px;font-size:16px}
  .btn-row{display:flex;gap:8px}
  .btn{flex:1;padding:10px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer}
  .btn:hover{box-shadow:0 3px 10px rgba(0,0,0,0.06)}
  #result{margin-top:18px;padding:16px;border-radius:10px;border:1px dashed #dfe6ff;background:#fbfbff}
  .result-title{font-weight:700;font-size:18px;margin-bottom:8px}
  .result-body{white-space:pre-wrap;color:#333}
  .actions{margin-top:12px;display:flex;gap:8px}
  .action-btn{padding:8px 12px;border-radius:8px;border:0;background:#3b82f6;color:#fff;cursor:pointer}
  .action-btn.secondary{background:#6b7280}
  canvas{display:block;margin-top:12px;border-radius:8px;border:1px solid #eee}
  footer{margin-top:16px;font-size:13px;color:#666}
</style>
</head>
<body>
<div class="container">
  <h1>MBTIë¡œ ë³´ëŠ” ë‚˜ë‘ ì–´ìš¸ë¦¬ëŠ” ê°•ì•„ì§€ í…ŒìŠ¤íŠ¸ ğŸ¶</h1>
  <p class="lead">ì•„ë˜ ì§ˆë¬¸ì— 8ê°œ ëª¨ë‘ ë‹µí•˜ë©´ ë‹¹ì‹ ì˜ MBTIë¥¼ ì¶”ì •í•˜ê³ , ê·¸ MBTIì™€ ì–´ìš¸ë¦¬ëŠ” ê°•ì•„ì§€ ê²¬ì¢…ê³¼ ì„¤ëª…ì„ ë³´ì—¬ë“œë¦½ë‹ˆë‹¤.</p>

  <div id="quiz"></div>

  <div style="text-align:center;margin-top:10px">
    <button id="submit" class="action-btn">ê²°ê³¼ ë³´ê¸°</button>
    <button id="reset" class="action-btn secondary">ë‹¤ì‹œí•˜ê¸°</button>
  </div>

  <div id="result" style="display:none">
    <div class="result-title" id="result-title"></div>
    <div class="result-body" id="result-body"></div>
    <div class="actions">
      <button id="download" class="action-btn">ì¹´ë“œ PNGë¡œ ì €ì¥</button>
      <button id="copyText" class="action-btn secondary">í…ìŠ¤íŠ¸ ë³µì‚¬</button>
    </div>
    <canvas id="cardCanvas" width="820" height="420" style="display:none"></canvas>
  </div>

  <footer>ì›í•œë‹¤ë©´ ì´ ê¸°ë°˜ìœ¼ë¡œ ì´ë¯¸ì§€(ê²¬ì¢… ì‚¬ì§„) ë¶ˆëŸ¬ì˜¤ê¸°, SNS ê³µìœ  ë²„íŠ¼, ê²½í’ˆ ì‘ëª¨ í¼ ì¶”ê°€í•´ ë“œë ¤ìš”.</footer>
</div>

<script>
/* --- ë°ì´í„° (ìœ„ JSONì„ ê·¸ëŒ€ë¡œ ë‚´ì¥) --- */
const DATA = {
  questions: [
    {id:1,text:"íŒŒí‹°ì— ê°€ë©´ ì£¼ë¡œ ë¬´ì—‡ì„ í•˜ë‚˜ìš”?", a:{text:"ì‚¬ëŒë“¤ê³¼ ì–´ìš¸ë ¤ ë¨¼ì € ë§ ê±°ëŠ” í¸ (E)", score:{E:1}}, b:{text:"ì¡°ìš©íˆ ê´€ì°°í•˜ê±°ë‚˜ ì¹œí•œ ì‚¬ëŒë§Œ ë§Œë‚˜ëŠ” í¸ (I)", score:{I:1}}},
    {id:2,text:"ê²°ì •í•  ë•Œ ë¬´ì—‡ì— ë” ì˜ì§€í•˜ë‚˜ìš”?", a:{text:"í˜„ì‹¤ì  ì‚¬ì‹¤ê³¼ ê²½í—˜ (S)", score:{S:1}}, b:{text:"ì§ê´€ê³¼ ê°€ëŠ¥ì„± (N)", score:{N:1}}},
    {id:3,text:"ê°ˆë“± ìƒí™©ì—ì„œ ë‚˜ëŠ”?", a:{text:"ë…¼ë¦¬(ì›ì¸Â·í•´ê²°) ì¤‘ì‹¬ìœ¼ë¡œ ì ‘ê·¼ (T)", score:{T:1}}, b:{text:"ê°ì •ê³¼ ê´€ê³„ë¥¼ ê³ ë ¤í•´ ê²°ë¡  (F)", score:{F:1}}},
    {id:4,text:"ê³„íš ì„¸ìš¸ ë•Œ ë‚˜ëŠ”?", a:{text:"ë¯¸ë¦¬ ê³„íší•´ ë‘ëŠ” í¸ (J)", score:{J:1}}, b:{text:"ì¦‰í¥ì ìœ¼ë¡œ ìœ ì—°í•˜ê²Œ ê°€ëŠ” í¸ (P)", score:{P:1}}},
    {id:5,text:"íœ´ì¼ì— ë‹¹ì‹ ì´ë¼ë©´?", a:{text:"ì—¬ëŸ¿ì´ë‘ í™œë™ì ìœ¼ë¡œ ë³´ë‚´ê¸° (E)", score:{E:1}}, b:{text:"ì§‘ì—ì„œ í˜¼ì/ì ì€ ì‚¬ëŒê³¼ ì‰¬ê¸° (I)", score:{I:1}}},
    {id:6,text:"ìƒˆë¡œìš´ ê²ƒ ë°°ìš¸ ë•Œ ì„ í˜¸ëŠ”?", a:{text:"ê²€ì¦ëœ ë°©ë²•ê³¼ ì‹¤ìŠµ (S)", score:{S:1}}, b:{text:"ì´ë¡ Â·ì›ë¦¬Â·ì•„ì´ë””ì–´ ë¨¼ì € (N)", score:{N:1}}},
    {id:7,text:"ì¹œêµ¬ê°€ ê³ ë¯¼ ìƒë‹´í•˜ë©´ ë‹¹ì‹ ì€?", a:{text:"ì§ì„¤ì ìœ¼ë¡œ í•µì‹¬ ì§€ì  (T)", score:{T:1}}, b:{text:"ê³µê°í•˜ê³  ê°ì • ë¨¼ì € ì•ˆì • (F)", score:{F:1}}},
    {id:8,text:"ì¼í•  ë•Œ ë‹¹ì‹ ì˜ ìŠ¤íƒ€ì¼ì€?", a:{text:"ë§ˆê°Â·ëª©í‘œ ë§ì¶° ì²´ê³„ì ìœ¼ë¡œ (J)", score:{J:1}}, b:{text:"ìƒí™©ì— ë”°ë¼ ìœ ì—°í•˜ê²Œ ë³€ê²½ (P)", score:{P:1}}}
  ],
  mbti_to_dog: {
    "ISTJ": {"breed":"German Shepherd","dog_personality":"ì±…ì„ê° ìˆê³  ì‹ ì¤‘í•˜ë©° ì£¼ì¸ì—ê²Œ ì¶©ì„±ì‹¬ì´ ê°•í•¨. ê·œì¹™ê³¼ ì¼ê´€ì„±ì„ ì¢‹ì•„í•¨.","mbti_desc":"ISTJ: í˜„ì‹¤ì ì´ê³  ì‹¤ìš©ì ì¸ ê´€ë¦¬ìí˜•. ì „í†µì„ ì¤‘ì‹œí•˜ê³  ë§¡ì€ ë°”ë¥¼ ëê¹Œì§€ í•´ëƒ„."},
    "ISFJ": {"breed":"Golden Retriever","dog_personality":"ì˜¨í™”í•˜ê³  ì‚¬ëŒì„ ì˜ ë”°ë¥´ë©° ë°°ë ¤ì‹¬ì´ ê°•í•¨. ê°€ì¡± ì§€í–¥ì .","mbti_desc":"ISFJ: ì˜¨í™”í•œ ìˆ˜í˜¸ìí˜•. íƒ€ì¸ì„ ëŒë³´ê³  ì•ˆì •ê°ì„ ì œê³µí•˜ëŠ” ê²ƒì„ ì¦ê¹€."},
    "INFJ": {"breed":"Cavalier King Charles Spaniel","dog_personality":"ì„¬ì„¸í•˜ê³  ì˜¨ìˆœí•˜ë©° ì‚¬ëŒ ê¸°ë¶„ì„ ì˜ ì½ìŒ. ì¡°ìš©í•œ ì• êµí˜•.","mbti_desc":"INFJ: ì´ìƒì£¼ì˜ì  ì¡°ì–¸ì. ê¹Šì€ í†µì°°ê³¼ ê³µê°ì„ ë°”íƒ•ìœ¼ë¡œ ì›€ì§ì„."},
    "INTJ": {"breed":"Shiba Inu","dog_personality":"ë…ë¦½ì ì´ê³  ê³ ì§‘ìŠ¤ëŸ¬ìš°ë©° ìŠ¤ìŠ¤ë¡œ ìƒê°í•˜ëŠ” íƒ€ì…. ê¹”ë”í•œ ì„±í–¥.","mbti_desc":"INTJ: ì „ëµê°€í˜•. ì¥ê¸°ì  ê³„íšê³¼ êµ¬ì¡°ë¥¼ ì„¸ìš°ëŠ” ë° ëŠ¥ìˆ™."},
    "ISTP": {"breed":"Jack Russell Terrier","dog_personality":"ëª¨í—˜ì„ ì¦ê¸°ê³  ì†ì¬ì£¼ê°€ ì¢‹ìœ¼ë©° ë¬¸ì œ í•´ê²°ì„ ì˜í•¨. í™œë™ì .","mbti_desc":"ISTP: ì¥ì¸í˜• ë¬¸ì œ í•´ê²°ì. í˜„ì‹¤ì ì´ê³  ì¦‰ê°ì ì¸ ëŒ€ì‘ì„ ì˜í•¨."},
    "ISFP": {"breed":"Beagle","dog_personality":"ê°ì„±ì ì´ê³  í˜¸ê¸°ì‹¬ ë§ìœ¼ë©° ëŠê¸‹í•œ ë§¤ë ¥. ì‚¬ëŒê³¼ ì˜ ì–´ìš¸ë¦¼.","mbti_desc":"ISFP: ì˜ˆìˆ ê°€í˜•. ê°ê°ì ì´ê³  í˜„ì¬ë¥¼ ì¦ê¸°ë©° íƒ€ì¸ì˜ ì„ íƒì„ ì¡´ì¤‘."},
    "INFP": {"breed":"Samoyed","dog_personality":"ì˜¨í™”í•˜ê³  ì´ìƒì£¼ì˜ì ì´ë©° ë”°ëœ»í•œ ì„±ê²©. ì• ì • í‘œí˜„ì´ í’ë¶€í•¨.","mbti_desc":"INFP: ì¤‘ì¬ìí˜•. ê°€ì¹˜ì™€ ì´ìƒì„ ì¤‘ì‹œí•˜ë©° ë‚´ë©´ì  ë™ê¸°ê°€ ê°•í•¨."},
    "INTP": {"breed":"Basenji","dog_personality":"ì§€ì ì´ê³  ë…ë¦½ì ì´ë©° í˜¸ê¸°ì‹¬ì´ ë§ìŒ. í˜¼ìì„œ íƒêµ¬í•˜ëŠ” ê±¸ ì¢‹ì•„í•¨.","mbti_desc":"INTP: ë¶„ì„ê°€í˜•. ë…¼ë¦¬ì™€ ì´ë¡ ì„ í†µí•´ ë¬¸ì œë¥¼ íƒêµ¬í•¨."},
    "ESTP": {"breed":"Boxer","dog_personality":"í™œë°œí•˜ê³  ì§ì„¤ì ì´ë©° ëª¨í—˜ì‹¬ ê°•í•¨. ì¦‰í¥ì  ì—ë„ˆì§€ê°€ ë„˜ì¹¨.","mbti_desc":"ESTP: ì‹¤í–‰ê°€í˜•. í–‰ë™ì´ ë¹ ë¥´ê³  í˜„ì¥ì—ì„œ í•´ê²°ì±…ì„ ì°¾ìŒ."},
    "ESFP": {"breed":"Labrador Retriever","dog_personality":"ì‚¬êµì ì´ê³  ì¦ê±°ì›€ì„ ì¶”êµ¬í•˜ë©° ì‚¬ëŒê³¼ì˜ êµë¥˜ë¥¼ ì¦ê¹€.","mbti_desc":"ESFP: ì—°ì˜ˆì¸í˜•. ìˆœê°„ì˜ ì¦ê±°ì›€ì„ ì˜ ì‚´ë¦¬ê³  íƒ€ì¸ì— ë°ìŒ."},
    "ENFP": {"breed":"Poodle","dog_personality":"ì°½ì˜ì ì´ê³  ì¥ë‚œê¾¸ëŸ¬ê¸° ê°™ìœ¼ë©° ì‚¬ëŒì„ ì˜ ëŒì–´ë‹¹ê¹€.","mbti_desc":"ENFP: ì¬ëŠ¥ë°œê²¬ê°€. ì•„ì´ë””ì–´ê°€ í’ë¶€í•˜ê³  ì‚¬ëŒì„ ì˜ê°í•˜ê²Œ í•¨."},
    "ENTP": {"breed":"Australian Shepherd","dog_personality":"ê¸°ë¯¼í•˜ê³  ì¥ë‚œê¸° ìˆìœ¼ë©° ìƒˆë¡œìš´ ìê·¹ì— ë¹ ë¥´ê²Œ ë°˜ì‘í•¨.","mbti_desc":"ENTP: ë°œëª…ê°€í˜•. í† ë¡ ê³¼ ì°½ì˜ì  ë„ì „ì„ ì¦ê¹€."},
    "ESTJ": {"breed":"Rottweiler","dog_personality":"ë‹¨í˜¸í•˜ê³  ì¡°ì§ì ì´ë©° ì±…ì„ê°ì´ ê°•í•¨. ë³´í˜¸ ë³¸ëŠ¥ì´ í¼.","mbti_desc":"ESTJ: ì§‘í–‰ìí˜•. êµ¬ì¡°ì™€ ê·œì¹™ì„ ì„¸ì›Œ ì‹¤í–‰í•˜ëŠ” ë° ë›°ì–´ë‚¨."},
    "ESFJ": {"breed":"Corgi","dog_personality":"ì‚¬êµì ì´ê³  íƒ€ì¸ì„ ì±™ê¸°ë©° íŒ€í”Œë ˆì´ì— ê°•í•¨.","mbti_desc":"ESFJ: ì œê³µìí˜•. ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ê³  íƒ€ì¸ì„ ë•ëŠ” ë° ë§Œì¡±ê°ì„ ëŠë‚Œ."},
    "ENFJ": {"breed":"Border Collie","dog_personality":"ë¦¬ë”ì‹­ ìˆê³  ì£¼ì˜ë¥¼ ì˜ ëŒë©° ì‚¬ëŒì„ ì´ë„ëŠ” ì—ë„ˆì§€.","mbti_desc":"ENFJ: ì–¸ì–´ë¡œ ì´ë„ëŠ” ë¦¬ë”. íƒ€ì¸ì˜ ì ì¬ë ¥ì„ ëŒì–´ë‚´ëŠ” ë° ëŠ¥í•¨."},
    "ENTJ": {"breed":"Siberian Husky","dog_personality":"ì•¼ë§ ìˆê³  ì—ë„ˆì§€ê°€ ë„˜ì¹˜ë©° ëª©í‘œì§€í–¥ì . ë•Œë¡  ë„ì „ì .","mbti_desc":"ENTJ: í†µì†”ìí˜•. ë¹„ì „Â·ì „ëµì„ ì„¸ì›Œ ì¡°ì§ì„ ì´ëŒì–´ê°."}
  },
  result_template: {
    title: "ë‹¹ì‹ ì˜ MBTI: {mbti} â€” ì–´ìš¸ë¦¬ëŠ” ê°•ì•„ì§€: {breed}",
    body: "{mbti_desc}\n\nê°•ì•„ì§€ ì„±ê²©: {dog_personality}\n\ní•´ì„: {interpretation}"
  }
};

/* --- UI ë Œë”ë§ --- */
const quizEl = document.getElementById('quiz');
const submitBtn = document.getElementById('submit');
const resetBtn = document.getElementById('reset');
const resultBlock = document.getElementById('result');
const resultTitle = document.getElementById('result-title');
const resultBody = document.getElementById('result-body');
const downloadBtn = document.getElementById('download');
const copyTextBtn = document.getElementById('copyText');
const canvas = document.getElementById('cardCanvas');
const ctx = canvas.getContext('2d');

let answers = {}; // id -> 'a' or 'b'

function renderQuiz(){
  quizEl.innerHTML = '';
  DATA.questions.forEach(q=>{
    const qdiv = document.createElement('div');
    qdiv.className = 'q';
    qdiv.innerHTML = `<h3>${q.id}. ${q.text}</h3>`;
    const btnRow = document.createElement('div'); btnRow.className='btn-row';
    const aBtn = document.createElement('button'); aBtn.className='btn'; aBtn.textContent = 'A. '+q.a.text;
    const bBtn = document.createElement('button'); bBtn.className='btn'; bBtn.textContent = 'B. '+q.b.text;
    aBtn.onclick = ()=>{ answers[q.id]='a'; markSelected(q.id); };
    bBtn.onclick = ()=>{ answers[q.id]='b'; markSelected(q.id); };
    btnRow.appendChild(aBtn); btnRow.appendChild(bBtn);
    qdiv.appendChild(btnRow);
    quizEl.appendChild(qdiv);
  });
}

function markSelected(qid){
  const qdiv = quizEl.querySelectorAll('.q')[qid-1];
  const buttons = qdiv.querySelectorAll('.btn');
  buttons.forEach(b=>b.style.borderColor='#ddd');
  const choice = answers[qid];
  if(choice==='a') buttons[0].style.borderColor='#3b82f6';
  if(choice==='b') buttons[1].style.borderColor='#3b82f6';
}

function calcMBTI(){
  // ì§‘ê³„: E vs I, S vs N, T vs F, J vs P
  const score = {E:0,I:0,S:0,N:0,T:0,F:0,J:0,P:0};
  for(const q of DATA.questions){
    const pick = answers[q.id];
    if(!pick) continue;
    const sc = (pick==='a')? q.a.score : q.b.score;
    for(const k in sc) score[k] += sc[k];
  }
  const letter = (score.E>=score.I ? 'E' : 'I') +
                 (score.S>=score.N ? 'S' : 'N') +
                 (score.T>=score.F ? 'T' : 'F') +
                 (score.J>=score.P ? 'J' : 'P');
  return {letter,score};
}

function makeInterpretation(mbti){
  // ê°„ë‹¨í•œ í•´ì„ ë¬¸ì¥(ê²°ê³¼ í…œí”Œë¦¿ì— ë„£ì„ ë¶€ë¶„)
  const base = DATA.mbti_to_dog[mbti];
  if(!base) return "ê²°ê³¼ë¥¼ í•´ì„í•˜ëŠ” ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
  // ë§ì¶¤ í•´ì„ ì˜ˆì‹œ: MBTI ì„±í–¥ê³¼ ê°•ì•„ì§€ ì„±ê²© ì—°ê²°
  const interp = `ë‹¹ì‹ ì€ ${mbti} ì„±í–¥ì„ ê°€ì§„ ì‚¬ëŒìœ¼ë¡œ, ${base.mbti_desc} ì´ë©°,\n${base.dog_personality} íŠ¹ì„±ê³¼ ì˜ ì–´ìš¸ë¦½ë‹ˆë‹¤. í•¨ê»˜ ì§€ë‚´ë©´ ì„œë¡œì˜ ì•ˆì •ê³¼ í™œë ¥ì„ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆì–´ìš”.`;
  return interp;
}

function showResult(){
  // ìœ íš¨ì„± ê²€ì‚¬: ëª¨ë“  ì§ˆë¬¸ ì‘ë‹µí–ˆëŠ”ì§€ ì²´í¬
  if(Object.keys(answers).length < DATA.questions.length){
    alert('ëª¨ë“  ì§ˆë¬¸ì— ë‹µí•´ì£¼ì„¸ìš”!');
    return;
  }
  const {letter} = calcMBTI();
  const info = DATA.mbti_to_dog[letter];
  const interpretation = makeInterpretation(letter);
  const title = DATA.result_template.title.replace('{mbti}', letter).replace('{breed}', info.breed);
  const body = DATA.result_template.body
                .replace('{mbti_desc}', info.mbti_desc)
                .replace('{dog_personality}', info.dog_personality)
                .replace('{interpretation}', interpretation);
  resultTitle.textContent = title;
  resultBody.textContent = body;
  resultBlock.style.display = 'block';
  // draw canvas card for download
  drawCard(letter, info, interpretation);
}

function drawCard(mbti, info, interpretation){
  // canvas ì´ˆê¸°í™”
  const w = canvas.width, h = canvas.height;
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0,0,w,h);
  // left area: big emoji/dog placeholder
  ctx.fillStyle = '#f1f5f9';
  ctx.fillRect(0,0,320,h);
  ctx.fillStyle = '#222';
  ctx.font = 'bold 36px sans-serif';
  ctx.fillText(info.breed, 18, 60);
  ctx.font = '24px sans-serif';
  ctx.fillText('MBTI: '+mbti, 18, 100);
  // dog emoji simple representation
  ctx.font = '80px serif';
  ctx.fillText('ğŸ¶', 110, 220);
  // right area: text
  ctx.fillStyle = '#111827';
  ctx.font = '20px sans-serif';
  wrapText(ctx, info.mbti_desc, 340, 40, 460, 26);
  ctx.font = '18px sans-serif';
  wrapText(ctx, 'ê°•ì•„ì§€ ì„±ê²©: ' + info.dog_personality, 340, 180, 460, 22);
  ctx.font = '16px sans-serif';
  wrapText(ctx, interpretation, 340, 260, 460, 20);
  canvas.style.display = 'block';
}

function wrapText(context, text, x, y, maxWidth, lineHeight) {
  const words = text.split(' ');
  let line = '';
  for (let n = 0; n < words.length; n++) {
    const testLine = line + words[n] + ' ';
    const metrics = context.measureText(testLine);
    const testWidth = metrics.width;
    if (testWidth > maxWidth && n > 0) {
      context.fillText(line, x, y);
      line = words[n] + ' ';
      y += lineHeight;
    } else {
      line = testLine;
    }
  }
  context.fillText(line, x, y);
}

submitBtn.addEventListener('click', showResult);
resetBtn.addEventListener('click', ()=>{
  answers = {};
  renderQuiz();
  resultBlock.style.display='none';
  canvas.style.display='none';
});

downloadBtn.addEventListener('click', ()=>{
  const link = document.createElement('a');
  link.download = 'mbti_dog_card.png';
  link.href = canvas.toDataURL('image/png');
  link.click();
});

copyTextBtn.addEventListener('click', ()=>{
  const text = resultTitle.textContent + "\\n\\n" + resultBody.textContent;
  navigator.clipboard.writeText(text).then(()=>alert('ê²°ê³¼ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'), ()=>alert('ë³µì‚¬ ì‹¤íŒ¨'));
});

/* ì²˜ìŒ ë Œë” */
renderQuiz();
</script>
</body>
</html>